\documentclass[12pt,a4paper]{article}

% ====== Packages ======
\usepackage[utf8]{inputenc}
\usepackage{amsmath, amssymb}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, positioning, shapes.geometric}
\usepackage[numbers]{natbib}  % For bibliography
\usepackage{graphicx,booktabs}    % Figures



% ====== Page setup ======
\geometry{margin=1in}
\setstretch{1.2}

% ====== Title ======
\title{Summary Report: simLIBS Python Library to generate LIBS specrums}
\author{Ehsan Namjoo}
\date{\today}

\begin{document}
	
	\maketitle
	\tableofcontents
	\newpage
	\section{Introduction}
	Simulated Laser-induced Breakdown Spectroscopy (LIBS) spectra play a crucial role in research and development by providing a cost-effective and flexible alternative to experimental measurements. The simLIBS Python package is a useful tool designed to simulate LIBS spectra based on input plasma parameters and elemental compositions. It leverages atomic data and spectral libraries to generate realistic spectral profiles over specified wavelength ranges and resolutions.
	
	In this report, the simLIBS package is introduced in detail, and its use in generating LIBS spectra for different steel grades by specifying their elemental compositions is demonstrated. Compositions are sampled within typical alloying ranges, and iron content is balanced accordingly. It is shown that even when concentrations varying widely within the allowable range for a given grade are selected, the resulting spectra are not significantly altered. Additionally, only minor differences are exhibited between LIBS spectra of different steel grades from similar families. It is also demonstrated that plasma physical parameters, plasma temperature and electron density, have a significant effect on the resulting spectra. The report concludes by raising questions regarding the conditions and usefulness of creating LIBS spectral datasets, as well as the structure of machine learning algorithms that could be employed for LIBS signal classification and concentration estimation. 
	
	\section{simLIBS package}
	\textbf{simLIBS} (Simulated LIBS) is a Python package designed for simulating LIBS spectra by utilizing spectral data from the NIST LIBS database \cite{NIST_LIBS}. Comprehensive documentation and details about the package can be found in \cite{simLIBS2024}. The package can be easily installed using the following command:
	
	\vspace{-0.5em}
	\begin{verbatim}
		pip install simLIBS
	\end{verbatim}
	\vspace{-1.5em}
	
		It is compatible with python 3.8 and above. The following command creates a simulated LIBS spectrum using the \texttt{SimulatedLIBS} class by specifying plasma conditions, elemental composition, and spectral parameters:
		\vspace{-0.5em}
		\begin{verbatim}
			libs = SimulatedLIBS(Te=1.0,
			Ne=10^{17},
			elements=['W','Fe','Mo'],
			percentages=[50,25,25],
			resolution=1000,
			low_w=200,
			upper_w=1000,
			max_ion_charge=3,
			webscraping='static')
		\end{verbatim}
		\vspace{-1.5em}
		
		Here, \texttt{Te=1.0} sets the electron temperature in electronvolts (eV). The electron temperature, controls the distribution of electrons among energy levels. Higher \texttt{Te} values correspond to hotter plasmas, leading to greater excitation and ionization of atoms, which significantly influences both the intensity and presence of spectral lines. \texttt{Ne=10\textasciicircum17} defines the electron density in cm\textsuperscript{-3}. The electron density  determines the number of free electrons in the plasma volume. The \texttt{elements} parameter specifies the elements included in the plasma, in this case, tungsten (W), iron (Fe), and molybdenum (Mo). Their relative atomic percentages are given by \texttt{percentages=[50,25,25]}, which sum to 100\%.
		
		The \texttt{resolution=1000} parameter controls the number of spectral data points, which indicates the number of discrete spectral points calculated over the chosen wavelength interval; higher resolution yields finer detail but may increase computation time. The wavelength range of the simulation is set from 200 nm to 1000 nm using \texttt{low\_w=200} and \texttt{upper\_w=1000}. The maximum ionization charge state considered for spectral lines is limited by \texttt{max\_ion\_charge=3}. \texttt{max\_ion\_charge} parameter restricts the calculation to a maximum ionization stage (e.g., 2+, 3+), which can be useful to reduce computational load or to exclude highly ionized species unlikely to occur under given plasma conditions.Finally, \texttt{webscraping='static'} indicates that pre-cached atomic data is used for the simulation, avoiding live data scraping.
		
		The simulated LIBS spectrum can be visualized directly using the \texttt{plot} method. For example, the command
		
		\vspace{-0.5em}
		\begin{verbatim}
			libs.plot(color='blue', title='W Fe Mo composition')
		\end{verbatim}
		\vspace{-1.5em}
		plots the spectrum in blue and assigns the title ``W Fe Mo composition'' to the figure. Figure \ref*{fig:libs-spectrum-FeWMo} show the resultant plot.
		\begin{figure}[h!]
			\centering
			\includegraphics[width=0.8\textwidth]{FeWMo.pdf}
			\caption{LIBS spectrum for simulated sample.}
			\label{fig:libs-spectrum-FeWMo}
		\end{figure}
		
		The \texttt{simLIBS} package provides several key methods, in addition to the \texttt{plot(color, title)} method, for working with simulated spectra. 
		The \texttt{get\_raw\_spectrum()} method returns the raw spectral data obtained from the NIST atomic 
		databases, whereas the \texttt{get\_interpolated\_spectrum()} method generates a cubic spline--interpolated 
		version of the spectrum for smoother visualization and analysis. 
		For exporting results, the \texttt{save\_to\_csv(filename)} method enables saving the spectral data 
		in CSV format for external processing. 
		Finally, the \texttt{plot\_ion\_spectra()} method facilitates the visualization of spectra corresponding 
		to different ionization stages of the elements included in the simulation.
		
	\section{Simulation results}
	In this section, several simulations using the \texttt{simLIBS} package are conducted to investigate the effects of variations in elemental concentrations and plasma conditions. For the first experiment, two composition sets were selected to represent typical values found in industrial AISI~4340 samples. These two sets, referred to as the \emph{minimum} and \emph{maximum} sets, contain concentrations according to the allowable range of the AISI~4340 grade. The minimum set contains the lower limits of each constituent element, while the maximum set contains the upper limits. For both sets, the iron content was calculated as the remainder required to reach a total composition of approximately $100\%$. In addition to iron, eight elements commonly found in the alloy were considered: carbon (C), manganese (Mn), molybdenum (Mo), phosphorus (P), silicon (Si), sulfur (S), nickel (Ni), and chromium (Cr). Table \ref{tab:astm4340} show the concentration ranges of the alloying elements.
	\begin{table}[htbp]
		\centering
		\caption{ASTM 4340 Steel – Chemical Composition}
		\label{tab:astm4340}
		\resizebox{\textwidth}{!}{%
			\begin{tabular}{@{} llcccccccc @{}} 
				\toprule
				\textbf{Standard} & \textbf{Grade} & \textbf{C (\%)} & \textbf{Mn (\%)} & \textbf{P (\%)} & \textbf{S (\%)} & \textbf{Si (\%)} & \textbf{Ni (\%)} & \textbf{Cr (\%)} & \textbf{Mo (\%)} \\
				\midrule
				ASTM A29 & 4340 & 0.38--0.43 & 0.60--0.80 & $\leq$0.035 & $\leq$0.040 & 0.15--0.35 & 1.65--2.00 & 0.70--0.90 & 0.20--0.30 \\
				\bottomrule
			\end{tabular}%
		}
	\end{table}
	
	
	LIBS spectra were generated for both composition sets under identical plasma parameters, with the electron temperature fixed at 1.0~eV and the electron density at $1 \times 10^{17}~\text{cm}^{-3}$. A spectral range from 200 to 1000~nm was used, with a resolution of 1000. Ionization states up to the third charge were included in the modeling to accurately account for the plasma emission characteristics.
	
	The resulting spectra plotted together for both concentration sets is depicted in Figure \ref{fig:min-max}.
	
	
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\textwidth]{min-max.pdf}
		\caption{Simulated LIBS spectra of AISI 4240 with different sompositions (min and max ranges).}
		\label{fig:min-max}
	\end{figure} 
	The spectra corresponding to the different composition sets appear to be nearly indistinguishable, effectively overlapping one another. This observation indicates that variations in elemental concentrations within the predefined compositional ranges for AISI 4240 do not significantly affect the overall LIBS spectral profile. In other words, small to moderate changes in alloy composition within these limits result in LIBS spectra that are largely similar.
	
	For the next experiment, under the same conditions as in the earlier experiment, the spectra of two different steel grades, AISI~4020 and AISI~4140, were compared (see Figure~\ref{fig:4020-4140}). The compositions for each grade were sampled uniformly within the predefined range for that grade. The results showed that, in this case as well, no significant differences were observed. Interestingly, the resulting spectra were very similar to those obtained in the earlier experiment for AISI~4340. The shapes of the spectra from both experiments are nearly identical; the only noticeable difference is that the peaks in the second experiment are slightly higher. This difference could be attributed to the higher percentage of iron, the predominant constituent, in the second experiment.
	
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\textwidth]{4020-4140.pdf}
		\caption{Simulated LIBS spectra of AISI 4020 vs 4140.}
		\label{fig:4020-4140}
	\end{figure} 

	As the third experiment, under the same conditions, the spectra of four different steel grades—AISI~4140, AISI~304, AISI~1095, and AISI~4340—are presented in a single plot (see Figure~\ref{fig:4041-304-1095-4340}). 
	
 	I was observed that all four grades exhibit broadly similar spectral profiles, with pronounced peaks in the 220–280~nm region and significantly lower intensities beyond 300~nm. The pattern of peaks across all spectra, closely resembling the patterns observed in earlier experiments. The spectra of AISI~4140, AISI~1095, and AISI~4340 are nearly identical in both shape and intensity, indicating similar elemental compositions dominated by iron with only minor alloying differences. In contrast, the spectrum of AISI~304 shows slight deviations, particularly in the relative intensities of the main peaks near 230~nm and 260~nm. These differences are most likely attributable to its higher nickel and chromium contents compared to the other grades. 
 	
 	
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\textwidth]{4041-304-1095-4340.pdf}
		\caption{Simulated LIBS spectra of four different steel grades.}
		\label{fig:4041-304-1095-4340}
	\end{figure} 
	
	For the next experiment, the effect of electron temperature ($T_e$) on the LIBS spectrum is investigated. To this end, three different values of electron temperature (1.0~eV, 0.8~eV, and 0.6~eV) are considered for generating the LIBS spectrum of the AISI~4140 steel grade (See Figure \ref{fig:Effect of T_e}). 
	
	In the low-wavelength region (200--350~nm), the spectrum for $T_e = 1.0$~eV exhibits the most prominent peaks. The $T_e = 0.8$~eV curve shows moderately strong peaks, while the $T_e = 0.6$~eV curve displays the weakest intensities. This pattern indicates that higher electron temperatures significantly increase the population of excited states, thereby improving the intensity of high-energy transitions. 
	
	However, the intensity improvement does not follow a consistent trend across the entire wavelength range. In the intermediate-wavelength region (350--450~nm), the spectra corresponding to lower electron temperatures ($T_e$) exhibit stronger peaks, and the differences between the three curves become less pronounced. This suggests that lower $T_e$ values may favor transitions from lower-energy states, which are more populated at reduced temperatures.
	
	It is also observed that changing the electron temperature affects the overall curve patterns and may appear to shift the positions of certain peaks. Nevertheless, since the wavelengths associated with specific elements are intrinsic and fixed, any apparent peak shifts are more likely the result of changes in relative intensities. Such intensity variations can lead to misinterpretation in LIBS spectrum analysis.
	
		
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\textwidth]{Te.pdf}
		\caption{Effect of $T_e$ on AISI~4140 spectrum.}
		\label{fig:Effect of T_e}
	\end{figure}
	
	For the final experiment, the effect of varying the electron density on the LIBS spectrum is investigated. The experimental conditions are the same as in the previous study, except that the electron temperature is fixed at $T_e = 1.0$~eV, while three electron density values are considered: $1\times10^{16}$~cm$^{-3}$, $1\times10^{17}$~cm$^{-3}$, and $1\times10^{18}$~cm$^{-3}$. Figure~\ref{fig:Effect of N_e} illustrates the results for this case.
	
	 As it is observed from the Figure \ref{fig:Effect of N_e}, in the low-wavelength region, all three spectra exhibit strong peaks. The spectrum at $N_e = 1\times 10^{16}$~cm$^{-3}$ shows slightly higher peak intensities than the others.
	
	In the intermediate-wavelength range (300--450~nm), the $N_e = 1\times 10^{18}$~cm$^{-3}$ case shows more pronounced smaller peaks compared to the other densities, suggesting enhanced excitation of certain lower-energy transitions at very high electron densities. Beyond 450~nm, all spectra show very low intensities, indicating that the dominant transitions for this material occur in the UV region under the chosen plasma conditions.
	
	These results demonstrate that varying $N_e$ primarily affects the relative intensities and widths of the emission lines through collisional excitation, Stark broadening, and possible self-absorption effects, while the peak positions remain unchanged, as the wavelengths are intrinsic to the elements present in the sample.
	
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.8\textwidth]{Ne.pdf}
		\caption{Effect of $N_e$ on AISI~4140 spectrum.}
		\label{fig:Effect of N_e}
	\end{figure}

	
	\section{Dataset Generation}
	The package provides a \texttt{create\_dataset} method to generate large synthetic datasets from a composition table, varying plasma parameters (\texttt{Te} and \texttt{Ne}) within user-defined ranges.
	
	Example input table:
	
	\begin{center}
		\begin{tabular}{cccc}
			\toprule
			W & H & He & name \\
			\midrule
			50 & 25 & 25 & A \\
			30 & 60 & 10 & B \\
			40 & 40 & 20 & C \\
			\bottomrule
		\end{tabular}
	\end{center}
	
	\section{Educational and Visualization Tools}
	simLIBS supports animated visualizations of how LIBS spectra change with:
	\begin{itemize}
		\item Spectral resolution,
		\item Electron temperature (\texttt{Te}),
		\item Electron density (\texttt{Ne}).
	\end{itemize}
	
	\section{References and Applications}
	\begin{itemize}
		\item Developed by Marcin Kastek (IPPLM).
		\item Applied in LIBS research:
		\begin{itemize}
			\item M. Kastek et al., \textit{Spectrochimica Acta Part B} (2022).
			\item Chen et al., \textit{Optics Letters} (2023).
		\end{itemize}
	\end{itemize}
	
	\section{Summary Table}
	\begin{center}
		\begin{tabular}{@{}ll@{}}
			\toprule
			\textbf{Feature} & \textbf{Description} \\
			\midrule
			Purpose & Simulate LIBS spectra using NIST data \\
			Install & \verb|pip install simLIBS| \\
			Inputs & Te, Ne, elements, percentages, wavelength range, resolution \\
			Outputs & Plots, raw/interpolated spectra, CSV files \\
			Dataset Tool & \verb|create_dataset| for bulk generation \\
			Educational Use & Animations for teaching \\
			License & MIT, Python $\geq$ 3.8 \\
			\bottomrule
		\end{tabular}
	\end{center}
	\section{Appendix}
	From a physical perspective, the population of excited states follows the Boltzmann distribution:
	\[
	n_i \propto g_i \exp\left(-\frac{E_i}{k_B T_e}\right)
	\]
	where $E_i$ is the excitation energy of state $i$, $g_i$ is its degeneracy, and $k_B$ is Boltzmann’s constant. As $T_e$ increases, the population of higher-energy states rises, leading to stronger emissions at shorter wavelengths. Conversely, lower $T_e$ favors transitions from lower-energy states, which may appear relatively stronger due to the reduced population of higher-energy levels.
	
	\textbf{Key takeaway:} The effect of electron temperature on line intensity is wavelength-dependent. High-energy transitions become more prominent at higher $T_e$, while some lower-energy transitions may be relatively stronger at lower $T_e$. The spectral response is thus governed by the excitation energy of each atomic transition.
	
		% ---------- References ----------
	\newpage
	%	\bibliographystyle{plainnat}
	\bibliographystyle{unsrtnat}
	%	\bibliographystyle{abbrvnat}
	\bibliography{references}  % Create a file named references.bib
	

	
\end{document}
